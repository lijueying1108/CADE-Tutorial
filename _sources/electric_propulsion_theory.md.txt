# **Electric Propulsion Theory Manual**

This is a theory manual for electric propulsion analysis inside CADE-MDA.

It is written by referring to the books:

> [1] Alam, Mohammad Irfan, et al. "Integrated Propulsion System Analysis Framework for Designing Advanced Air Mobility Aircraft." IEEE Transactions on Transportation Electrification (2024).

> [2] Lee, Jae Lyun, et al. "Enhanced calibration and performance prediction method for entire propulsion system of eVTOL UAV." IEEE Transactions on Transportation Electrification 10.3 (2023): 5735-5749.

> [3] Yao, Anker C. "Equilibrium Analysis and Design Optimization of Power Converters: Principles, Challenges, and Future Directions." (2025).

> [4] Clarke, Matthew, and Juan J. Alonso. "Lithium–ion battery modeling for aerospace applications." Journal of Aircraft 58.6 (2021): 1323-1335.
 
> [5] Tawfiq, Kotb B., Arafa S. Mansour, and Peter Sergeant. "Mathematical Design and Analysis of Three-Phase Inverters: Different Wide Bandgap Semiconductor Technologies and DC-Link Capacitor Selection." Mathematics 11.9 (2023): 2137.
 
> [6] Ahmed, Mohammed Hassan, et al. "Power loss model and efficiency analysis of three-phase inverter based on SiC MOSFETs for PV applications." IEEE Access 7 (2019): 75768-75781.

> [7] Dicks, Andrew L., and David AJ Rand. Fuel cell systems explained. John Wiley & Sons, (2018).

> [8] Hayes, John G., and G. Abas Goodarzi. "Electric powertrain: energy systems, power electronics and drives for hybrid, electric and fuel cell vehicles." (2018).

> [9] Wu, Qichao, Rui Huang, and Xiaoli Yu. "Measurement of thermophysical parameters and thermal modeling of 21,700 cylindrical battery." Journal of Energy Storage 65 (2023): 107338.
 
> [10] https://kr.mathworks.com/help/sps/ref/parktoclarkeangletransform.html 

<br>

## **Electric Propulsion**
In recent years, growing global environmental concerns and increasing urbanization have intensified various social challenges. In response, the concept of Advanced Air Mobility (AAM)—which encompasses Urban Air Mobility (UAM) and Regional Air Mobility (RAM)—has emerged as a next generation air transportation solution.

Unlike conventional fossil fuel-based aircraft, <span style="color:rgb(24, 80, 145);">AAM vehicles are characterized by their use of environmentally friendly, electric energy sources</span>. To accomodate their unique operational environments and requirements, these aircraft typically <span style="color:rgb(24, 80, 145);">adopt Distributed Electric Propulsion (DEP) systems.</span>

In the electric propulsion analysis module of CADE-MDA, the goal is to analyze the electric propulsion systems and their components, which are integrated into AAM platforms such as eVTOL (electric Vertical Take-Off and Landing) and eCTOL (electric Conventional Take-Off and Landing) aircrafts.

<br>

### Goal of Electric Propulsion Analysis
The objective of the aircraft propulsion analysis is to accurately estimate and predict the performance of each electric propulsion components and the overall performance of the system.

> 1. To analyze components in EPS System.
> 2. To understand electric and mechanical characteristics
> 3. To estimate performance of electric propulsion system

<br>

### Electric Propulsion Analysis Module Structure
This electric propulsion analysis module is divided into two parts: (1) UAV (Unmanned Aerial Vehicle) Propulsion analysis and (2) UAM Propulsion analysis. This is mainly because UAV and UAM adopts different types of propulsion components.

<span style="color:rgb(24, 80, 145);"> **UAV Propulsion**</span>

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/eps.png" alt="UAV Electric Propulsion in CADE" width="500">
    <figcaption>UAV Electric Propulsion Architecture</figcaption>
  </figure>
</div>

<br>

Some drones or small aircraft capable of short-distance flight are considered as UAVs. And this kind of vehicles are able to fly with current technology for electric propulsion system.

UAV adopts energy sources such as battery or hydrogen fuel cell system. Battery is the one of the electric proupsion unit that can generate electrical power, and here, the format of the electric power is represented as $V_{bat},I_{bat}$. For the controller, ESC (Electric Speed Control) can control the motor, which rotates the propeller, so from the battery, the ESC passes the electric power to run the motor as figure above. Electric motor used in UAV is mostly BLDC (Brushless DC) type and it can make the torque and RPM to rotate propeller. From the rotating propeller, thrust is generated.

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/system_analysis_flow.jpg" alt="System Analysis Flow" width="500">
    <figcaption>System Analysis Flowchart</figcaption>
  </figure>
</div>

<br>

In our electric propulsion analysis module inside CADE, all the analysis modules are integrated to calculate specific electric propulsion-related parameters.

* **Steps of System Analysis**

  1. Set Initial Value

  $$ RPM_i,I_{batt},I_{mot} $$

  2. Calculate Battery Voltage

  $$ V_{batt} = N_{cell}V_{cell}-I_{batt}R_{cell} $$

  3. Calculate ESC Voltage

  $$ V_{esc} = (V_{batt}-I_{mot}R_{esc})throttle $$

  4. Calculate Propeller Torque

  $$ P = C_p(\rho n^3D^3 )$$

  $$ Q = P/\omega $$

  5.  Calculate Motor required Current

  $$ I_{mot} = Q/(60/2\pi K_V)+I_0 $$

  6. Calculate Motor RPM

  $$ RPM_{i+1} = K_V*(V_{esc}-R_{mot}I_{mot}) $$

  7. Calculate Battery Current

  $$ I_{batt} = (N_{mot}*(I_{mot}V_{esc})+P_{sub})/V_{batt} $$

  8. If

  $$ RPM_{i+1} = RPM_{i} $$

  - Iteration stops, save the current analysis result

  9) If not,

  - Go back to Step [1]

  - Update $RPM,I_{batt},I_{mot}$

*Where,*

> *- $N_{mot}$ : Number of motor connected to battery*

<br>

<span style="color:rgb(24, 80, 145);"> **UAM Propulsion**</span>

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/prop-uam.png" alt="UAV Electric Propulsion Architecture" width="500">
    <figcaption>UAV Electric Propulsion Architecture</figcaption>
  </figure>
</div>

<br>

The propulsion system of an urban air mobility (UAM) vehicle begins with a battery that supplies direct current (DC) power. Then, a DC-DC converter adjusts this power to an appropriate voltage level before it is fed to the inverter. If the voltage of a battery ($V_{bat}$) is lower than $V_{dc}$, which is required from inverter or motor, the converter boost the voltage level-this is referred as a *'boost converter'*. Conversely, if $V_{bat}$ is higher than $V_{dc}$, the converter reduces the voltage level, functioning as a *'buck converter'*.

The inverter then converts the regulated DC power into alternating current (AC) power, which is required by motor. A controller manages this process by sending control signals to adjust the inverter's outpul, controlling the duty cycle to ensure stable and efficient motor operation. The controller also receives real-time feedback from the motor, enabling dynamic adjustments to optimize performance and efficiency. The motor, powered by AC current, generates torque, which is transmitted through a gearbox. The gearbox adjusts the torque and RPM to match the optimal operating conditions for the propeller. Finally, the propeller, driven by the adjusted torque and RPM, produces the necessary thrust to lift and propel the vehicle.

<br>

- **Battery Analysis**
  - Shepherd Model
    - Battery Chemistry Model
    - Battery Parameters
  - 1RC Thevenin Equivalent Circuit Model
    - Thermal Model
    - Calibration Module
- **Hydrogen Fuel Cell Analysis**
  - PEMFC Model
    - Gibbs Energy, Enthalpy, Entropy Relation
    - Nernst Equation
    - Useful Fuel Cell Equation
- **Electric Unit Analysis**
  - DC-DC Converter
    - Boost Converter Model
    - Buck Converter Model
    - Power Loss Model
  - 3-Phase Inverter
    - Power Loss Model
  - Electric Speed Controller (ESC)
    - Motor Controller
- **Electric Motor Analysis**
  - BLDC Motor
  - PMSM Motor
- **Propeller Analysis**
  - Blade Element Theory
  - Momentum Theory
  - Blade Element Momentum Theory
    - Constant Pitch Propeller
    - Variable Pitch Propeller

<br>

## **Battery Analysis**
The battery serves as the core energy source for the propulsion system, converting chemical energy into electrical energy. One important characteristic to consider is the voltage drop that occurs in each battery cell as the State of Charge (SOC) decreases. In other words, as the battery is discharged, the output voltage of each cell tends to decrease. The figure below illustrates the voltage drop behavior of a Li-Po (Lithium Polymer) battery. To analyze this, the process involves two main steps: (1) Calculate the drain current, (2) Calculate the SOC.

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/battery_Vsoc_drop.jpg" alt="Li-Po Battery Voltage Drop" width="400">
    <figcaption>Li-Po Battery Voltage Drop</figcaption>
  </figure>
</div>

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/Battery_scheme.jpg" alt="Battery Analysis Process" width="400">
    <figcaption>Battery Analysis Process</figcaption>
  </figure>
</div>

<br>

$$ Drain = I_{batt}*\Delta t $$

$$ SOC = ({Q_{batt} - Drain})/{Q_{batt}} $$

*Where,*

> *- $SOC$ : State of Charge [%]* <br>
> *- $I_{batt}$ : Current [$A$]* <br>
> *- $t$ : Time [s]* <br>
> *- $Q_{batt}$ : Current capacity [$Ah$]* <br>
> *- $R_{batt}$ : Battery resistance [$\Omega$]* <br>
> *- $V_{cutoff}$ : Cut-off voltage [V]* <br>
> *- $V_{cell}$ : Cell voltage [V]* <br>
> *- $R_{batt}$ : Resistance [$\Omega$]*

<br>

### Shepherd Equivalent Circuit Model
Eqivalent Circuit Model (ECM)-based approaches offer an optimal balance between modeling complexity and accuracy, making them a preferred choice for real-world applications. While models such as Thevenin and other higher-order ECMs can provide greater accuracy—typically within $\pm$ 1%— this framework adopts a modified version of the ECM to achieve better computational efficiency, reasonable accuracy and robustness. It simplifies the parameterization process using inputs derived from discharge characteristics or manufacturer data and is adaptable to a variety of battery chemistries and configurations. Furthermore, the modular structure of this framework enables easy integration of alternative models, offering the flexibility needed to address diverse analysis scenarios.

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/battery.png" alt="Battery Model Equivalent Circuit Diagram" width="400">
    <figcaption>Battery Model Equivalent Circuit Diagram</figcaption>
  </figure>
</div>

<br>

Below graph presents the typical discharge curve of a Li-ion battery, capturing three distinct regions. The first is the *exponential region*, characterized by a rapid voltage drop. Next is the *nominal region*, whre the voltage remains relatively stable, providing consistent power output. Finally, the curve enters to *cut-off point*, where the voltage drops sharply to the minimum operating limit, indicating the end of usable capacity to prevent battery damage.

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/battery_discharge_curve.png" alt="Li-Ion Battery Typical Discharge Curve" width="400">
    <figcaption>Li-Ion Battery Typical Discharge Curve</figcaption>
  </figure>
</div>

<br>

Here, we use a model incorporating polarization voltage as a time-dependent state variable, accounting for variations in output voltage. The discharge voltage is estimated:

<span style="color:rgb(24, 80, 145);">**Shepherd Model**</span>

$$\begin{aligned}
    V_{\mathrm{B}} = & \underbrace{V_{\mathrm{C}}-R_{\mathrm{B}} I_{\mathrm{B}}}_{\text{Equivalent circuit}} \notag \\
    & - \underbrace{K \frac{Q_{\mathrm{N}}}{Q_{\mathrm{N}}-\int_{L_{\mathrm{1}}}^{t_2} \frac{I_{\mathrm{B}}}{3600} \mathrm{d} t}\left(\int_{t_1}^{t_2} \frac{I_{\mathrm{B}}}{3600} \mathrm{d} t+I_{\mathrm{F}}\right)}_{\text{Polarization}}  \notag \\
    & + \underbrace{A \exp \left(-B \int_{t_1}^{t_2} \frac{I_{\mathrm{B}}}{3600} \mathrm{d} t\right)}_{\text{Exponential}}
\end{aligned} $$

$$ A = V_{\mathrm{F}}-V_{\mathrm{C}}+R_{\mathrm{B}} I_{\mathrm{B}}, \quad B=\frac{3}{Q_{\mathrm{E}}} $$

$$ K = -\frac{\left(Q_{\max} - Q_{\mathrm{N}}\right) \left[V_{\mathrm{N}} - V_{\mathrm{C}} + R_{\mathrm{B}} I_{\mathrm{B}} - A \exp \left(-B Q_{\mathrm{N}}\right)\right]}{Q_{\max} \left(Q_{\mathrm{N}} + I_{\mathrm{B}}\right)} $$

*Where,*

> *- $V_{B}$ : Battery terminal voltage [$V$]* <br>
> *- $V_{C}$ : Battery constant voltage [$V$]* <br>
> *- $V_{F}$ : Filtered battery voltage [$V$]* <br>
> *- $V_{N}$ : Battery nominal voltage [$V$]* <br>
> *- $K$ : Polarization constant [$V/Ah$]* <br>
> *- $Q_{N}$ : Nominal zone battery capacity [$Ah$]* <br>
> *- $Q_{max}$ : Maximum battery capacity [$Ah$]* <br>
> *- $Q_{E}$ : Exponential zone battery capacity [$Ah$]* <br>
> *- $I_{F}$ : Filtered battery current [$A$)]* <br>
> *- $I_{B}$ : Actual battery current [$A$]* <br>
> *- $A$ : Amplitude of the exponential zone [$V$]* <br>
> *- $B$ : Exponential zone time constant inverse [$Ah^{-1}$]* <br>
> *- $R_{B}$ : Internal resistance [$\Omega$]* <br>

* For estimation the State of Charge (SOC):

$$ \mathrm{SoC} = \frac{Q_{\max} - \int_{t_1}^{t_2} \frac{I_{\mathrm{B}}}{3600} \mathrm{d} t}{Q_{\max}} \times 100\% $$

Regarding the physical arrangement of batteries, they can be configured in series-parallel connections to achieve the desired pack voltage and current. The total pack voltage and current can be calculated by the numbers of series and parallel connections.

$$ V_{pack} = V_{B}N_{S} $$

$$ I_{pack} = I_{B}N_{P} $$

*Where,*

> *- $V_{pack}$ : Total battery pack voltage* <br>
> *- $I_{pack}$ : Total battery pack current* <br>
> *- $N_{S}$ : The number of series connections* <br>
> *- $N_{P}$ : The number of parallel connections*

<br>

#### Battery Chemistry Model

| **Chemistry** | **Voltage ($V_B$)** | **Model** |
|--------------|--------------------- |-----------|
| **Li-Ion** | **Discharge** | $V_{\mathrm{EC}} - K \frac{Q_{\mathrm{N}}}{Q_{\mathrm{N}} - Q_B}\left(Q_B + I_{\mathrm{F}}\right) + A \exp \left(-B Q_B\right)$ |
| | **Charge** | $V_{\mathrm{EC}} - K \frac{Q_{\mathrm{N}}}{Q_{\mathrm{B}} - 0.1 \cdot Q_N}I_{\mathrm{F}} - K \frac{Q_{\mathrm{N}}}{Q_{\mathrm{N}} - Q_{\mathrm{B}}}Q_{\mathrm{B}} + A \exp \left(-B Q_B\right)$ |

<br>

#### Battery Parameters

  | Type       | Li-Ion
  |------------|---------------
  | Parameters | 3.3V, 2.3Ah
  | $V_C$ [V]  | 3.366
  | $R_B$ [$\Omega$]  | 0.01
  | $K$ [$\Omega$]    | 0.0076
  | $A$ [V]    | 0.26422
  | $B$ [$Ah^{-1}$] | 26.5487

<br>

### 1RC Thevenin Equivalent Circuit Model

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/overall_sequence_of_battery_model.png" alt="Overall Sequence of Battery Model" width="600">
    <figcaption>Overall Sequence of Battery Model</figcaption>
  </figure>
</div>

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/1RC_equivalent_circuit_model.png" alt="1RC Equivalent Circuit Model" width="400">
    <figcaption>1RC Equivalent Circuit Model</figcaption>
  </figure>
</div>

<br>

1RC Equivalent Circuit Model(ECM) is a simplified electrical circuit used to represent a battery or other energy storage device, consisting of a single resistor ($R$) connected in parallel with a single capacitor ($C$), which together model the internal resistance and polarization effects within the device, providing a basic representation of its voltage response under current changes.

<span style="color:rgb(24, 80, 145);">**Basic 1RC Equivalent Circuit Model**</span>

$$ \frac {dV_{Th}}{dt} = \frac {I_{L}}{C_{Th}} - \frac {V_{Th}}{R_{Th}C_{Th}} $$

$$ V_{UL} = V_{OC} - V_{Th} - I_{L}R_{0} $$

*Where,*

> *- $V_{Th}$ : Thevenin equivalent voltage [$V$]* <br>
> *- $I_{L}$ : Load current [$A$]* <br>
> *- $C_{Th}$ : Thevenin equivalent capacitance [$F$]* <br>
> *- $R_{Th}$ : Polarization resistance [$\Omega$]* <br>
> *- $V_{UL}$ : Under-load voltage [$V$]* <br>
> *- $R_{0}$ : Ohmic resistance [$\Omega$]*

<br>

#### Thermal Model
The thermal model simulates the heat dynamics within the battery system by accounting for both internal heat generation and external heat dissipation. Internally, heat is produced primarily due to electrical resistance and electrochemical reactions. Externally, the model considers convective cooling, where heat is transferred from the battery surface to the surrounding environment. This balance between generated heat and convective loss allows for the prediction of the battery’s temperature evolution under various operating conditions, ensuring thermal safety and optimal performance of the system.
The thermal model predicts the battery's temperature evolution by balancing internally generated heat with heat removed through convection. It is built on two main components:

<span style="color:rgb(15, 135, 204);">**Heat Generation**</span>

Heat is generated inside the battery cell through two primary mechanisms:

* Irreversible (Joule) Heating:

This term accounts for losses due to the cell's internal resistance when current flows, and can be expressed as

$$ Q_{joule} = A_{e} i(V_{OC}-V_{UL}) = I_{out}(V_{OC}-V_{UL}) $$

*Where,*

> *- $A_{e}$ : Electrode area [$m^2$]* <br>
> *- $i$ : Current density [$A/m^2$]* <br>
> *- $I_{out}$ : Output current [$A$]*

<br>

* Reversible (Entropic) Heat:

The change in entropy during the electrochemical reaction produces a reversible heat term, expressed as

$$ Q_{entropy} = -I_{out}(T_{b} \frac{\delta V_{oc}}{\delta T_{b}}) $$

*Where,*

> *- $T_{b}$ : Battery temperature [$K$]*

<br>

The total heat generation is then given by the sum:

$$ Q_{heat} = Q_{joule} + Q_{entropy} $$

<br>

<span style="color:rgb(15, 135, 204);">**Heat Dissipation (Cooling)**</span>

The model assumes that the generated heat is removed by convective heat transfer to the surrounding environment. For a cell with surface area $A_{s}$, the convective cooling is modeled as:

$$ Q_{cooling} = \tilde hA_{s}(T_{b}-T_{\infty}) $$

*Where,*

> *- $\tilde h$ : Convection heat transfer coefficient [$W/m^2K$]* <br>
> *- $A_{s}$ : Battery surface area [$m^2$]* <br>
> *- $T_{\infty}$ : Ambient temperature [$K$]*

<br>

For air cooling system, it is essential to establish the battery cell arrangement. For a staggered cell arrangement, there is column and row and also this arrangement is honeycomb type. Honeycomb type is more efficient for cooling battery module and better energy density of the module than grid type.

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/cell arrangment.jpg" alt="Battery Cell Arrangement" width="400">
    <figcaption>Battery Cell Arrangement</figcaption>
  </figure>
</div>

<br>

$$ Nu = CRe_{D,max}^{m} Pr^{0.36}(\frac {Pr}{Pr_w})^{0.25} $$

$$ \text{where} \begin{cases} C=0.35 (\frac {S_{T}}{S_{L}})^{0.2}, \quad m= 0.6 & \text{if } \mathrm{Re_{D,max}} > 1\times 10^3, \\[10pt] C = 0.51, \quad m=0.5 & \text{otherwise}  \end{cases} $$

$$ Re_{D,max} = \frac {V_{max}D}\nu $$

$$ \text{where} \begin{cases}  V_{max} =  V_{\infty} \frac {S_{T}}{2(S_{D}-D)}, \quad \text{if } \mathrm{2(S_{D}-D) < S_{T}-D} \\[10pt] V_{max} =  V_{\infty} \frac {S_{T}}{(S_{T}-D)}, \quad \text{otherwise} \end{cases} $$

*Where,*

> *- $Nu$ : Nusselt number for the staggered arrangement* <br>
> *- $Pr$ : Prandtl number of the fluid at the inlet* <br>
> *- $Pr_{w}$ : Prandtl number of the fluid near the surface of the battery cells* <br>
> *- $S_{T}$ : Transverse pitch [$m$]* <br>
> *- $S_{L}$ : Longitudinal pitch [$m$]* <br>
> *- $S_{D}$ : Diagonal distance [$m$]* <br>
> *- $D$ : Cell diameter [$m$]* <br>
> *- $V_{\infty}$ : Maximum velocity of air [$m/s$]* <br>
> *- $\nu$ : Kinematic viscosity [$m^2/s$]* <br>
> *- $Re_{D,max}$ : Maximum flow in the tube bank characterized based on $Re$* <br>

When air flows through the battery cells, the heat exchange between the air and the battery cell is calculated as:

$$ Q_{cooling} = N_{tot}\tilde h A_{s}\Delta T_{LM} $$

$$ \Delta T_{LM} = \frac {(T_w-T_i)-(T_w-T_o)}{ln(\frac{T_w-T_i}{T_w-T_o})} $$

$$ \frac{T_w-T_i}{T_w-T_o} = \frac{exp(-\pi DN_{tot}\tilde h)}{\rho_{\infty}V_{\infty}N_{T}S_{T}c_{p_{\infty}}} $$

*Where,*

> *- $N_{tot}$ : Total number of cells in the module* <br>
> *- $\Delta T_{LM}$ : The log mean temperature difference* <br>
> *- $T_{w}$ : The battery cell surface temperature* <br>
> *- $T_{i}$ : The inlet temperature of the air passing through module* <br>
> *- $T_{o}$ : The outlet temperature of the air passing through module* <br>
> *- $\rho_{\infty}$ : Ambient air density [$kg/m^3$]* <br>
> *- $N_{T}$ : Number of columns in the battery module* <br>
> *- $N_{L}$ : Number of rows in the battery module* 

<br>

Then the net heat load and the cell temperature rise can be quantified using the following equations:

$$ Q_{net} = Q_{heat} - Q_{cooling} $$

$$ \frac{dT_b}{dt} =\frac{Q_{net}}{mC_p} $$

#### Calibration Model
The baseline 1RC Equivalent Circuit Model (ECM) parameters—such as ohmic resistance, polarization resistance, and other dynamic variables—were originally derived from extensive experimental data reported in the literature for common lithium-ion cells (e.g., 18650, 21700). These published datasets were used to generate general equations by plotting the measured data and fitting polynomial or other functional forms. However, because the derived equations represent an average or generalized behavior, they may not perfectly describe the performance of a specific cell type, even if it is of a similar design.

<span style="color:rgb(15, 135, 204);">*Why Calibration is Needed*</span>

When appling ECM with these generic parameters to model the voltage and dynamic behavior of our target cell, discrepancies emerged between the model predictions and the actual experimental measurements. These differences are especially pronounced under varying C-rate conditions, where the cell’s behavior can deviate from the idealized trends captured by the literature. To overcome this limitation, a calibration model that refines the ECM parameters to closely align with battery companies' experimental data is developed.

<span style="color:rgb(15, 135, 204);">*Theoretical Basis and Calibration Procedure*</span>

1. **Parameter Adjustment via Correction Coefficients:**

Four correction coefficient - denoted as $\alpha,\beta,\gamma$ and $\delta$ are introduced to modify the baseline parameters of ECM. These coefficients adjust the model equations, for instance by altering the resistance or voltage offset terms, so that the model accounts for variation due to different C-rates. In this case, modifications might take forms such as:

$$ R_{0_{cali}} = R_0\cdot (1- \alpha e^{\beta \cdot C_{rate}}) $$

$$ R_{Th_{cali}} = R_{Th}\cdot\frac{\gamma}{C_{rate}} $$

$$ C_{Th_{cali}} = C_{Th}\cdot\delta C_{rate} $$

2. **Error Minimization:**

An objective function, typically defined as the root-mean-square error (RMSE) between the ECM's predicted voltage and the experimental data, is established:

$$ RMSE(\alpha,\beta,\gamma,\delta) = \sqrt{\frac{1}{N}\sum_{i=1}^{N}\frac{(V_{model,i}-V_{data,i})^2}{N}} $$

Minimizing this RMSE over the entire range of state-of-charge (SoC) and multiple C-rate conditions ensures that the calibrated model accurately replicates the experimental behavior.

3. **Optimization Sequence:**

    The calibration process follows a defined sequence:

- Data Collection : Experimental voltage curves are gathered for different C-rates and SoC values.
- Initial Model Generation : The baseline 1RC ECM is computed using literature-based parameters.
- Error Evaluation : The difference between the model's predictions and the experimental data is quantified using the RMSE
- Parameter Optimization: Using an optimization algorithm (L-BFGS-B), the correction coefficients $\alpha,\beta,\gamma$ and $\delta$ are iteratively adjusted within pre-defined bounds to minimize the RMSE.
- Validation & Verification : The calibrated model is then validated by comparing its output with experimental data, ensuring that the predicted and actual responses closely align.

<br>

## **Hydrogen Fuel Cell Analysis**

### PEMFC Model
PEMFC(Proton Electrolyte Membrane Fuel Cell) is the energy source of the propulsion. It provides the electrical energy to the system from the chemical energy. First, open circuit voltage(OCV) of PEMFC is calculated based on thermodynamic equation. After that, Nernst equation of PEMFC is used for calculating fuel cell's voltage drop. Finally, voltage losses, which have a role of resistance of fuel cell calculated. To find stack voltage which satisfies $P_{FC}^{req}$ from propulsion analysis:

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/hfc_analysis.jpg" alt="PEMFC Analysis Process" width="400">
    <figcaption>PEMFC Analysis Process</figcaption>
  </figure>
</div>

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/voltage_power_matching.jpg" alt="PEMFC Performance Analysis" width="500">
    <figcaption>PEMFC Performance Analysis</figcaption>
  </figure>
</div>

<br>

<span style="color:rgb(15, 135, 204);">**PEMFC Modeling Equation**</span>

#### Gibbs Energy, Enthalpy, Entropy Relation

$$ s_T = s_{T_{air}} + \int_{T_{air}}^T\frac{c_{p}}{T}dT $$

$$ h_T = h_{T_{air}} + \int_{T_{air}}^T c_{p}dT $$

$$ \Delta g_{f} = \Delta h_f - T\Delta s_f $$

$$ V_{ocv} = -\Delta \frac{g_f}{2F} + \frac{RT}{2F} ln(\frac{a_{O_2}^{0.5}a_{H_2}}{a_{H_{2}O}}) $$

*Where,*

> *- $s_T$ : Entropy of gas* <br>
> *- $h_T$ : Enthalpy of gas* <br>
> *- $\Delta g_f$ : Gibbs free energy* <br>
> *- $c_p$ : Specific heat capacity* <br>
> *- $T$ : Fuel cell operating temperature [$K$]*

#### Nernst Equation

$$ V_{cell} = V_{ocv}-V_{act}-V_{ohm}-V_{mass} $$

$$V_{act} = A\cdot{ln(\frac{i_{den} + i_n}{i_0})} $$

$$ V_{ohm} = i_{den}R_{cell} $$

$$ V_{mass} = -B\cdot{ln(1-\frac{i_{den}}{i_l})} $$

*Where,*

> *- $A$ : Tafel constant [V]* <br>
> *- $i_n$ : Exchange current density [$mA/cm^2$]* <br>
> *- $i_{den}$ : Current density [$mA/cm^2$]* <br>
> *- $i_0$ : Inner current density [$mA/cm^2$]* <br>
> *- $i_l$ : Limiting current density [$mA/cm^2$]* <br>
> *- $B$ : Mass-transport parameters* <br>
> *- $a_A$ : The activities of the respective reactants*

<br>

#### Useful Fuel Cell Equations

* Oxygen and Air Usage Rate

$$ O_{2_{use}} = \frac{8.29\cdot 10^{-8}\cdot P_e}{V_c}\quad [kg/s] $$

$$ Air_{use} = \frac{3.58\cdot 10^{-7} \cdot\lambda\cdot P_e}{V_c}\quad [kg/s] $$

* Hydrogen Usage Rate

$$ H_{2_{use}} = \frac{1.05\cdot 10^{-8}\cdot P_e}{V_c}\quad [kg/s] $$

* Efficiency

$$ \eta = \frac{V_c}{1.48} $$

* Rate of Water Production

$$ H_{2}O_{produce} = \frac{9.34\cdot 10^{-8}\cdot P_e}{V_c}\quad [kg/s] $$

* Heat Production

$$ Heat Rate = P_e(\frac{1.25}{V_c}-1) $$

*Where,*

> *- $\lambda$ : Stoichiometry* <br>
> *- $P_e$ : Electric power* <br>
> *- $V_c$ : Cell voltage*

<br>

## **Electric Unit Analysis**

### DC-DC Converter
A DC-DC converter is an integral component in power supply applications, serving to adapt the voltage level of DC source to meet the requirements of various electric devices. In CADE, particularly in eVTOLs, High-voltage batteries or fuel cells employed in eVTOLs necessitate buck or boost converters to step up or down the voltage level to suitable levels for motors, avionics and other electric devices.

<br>

#### Boost Converter Model
A boost converter steps up the input voltage through the energy storage capability of an inductor. During the "on" phase, the switch is closed, allowing the inductor to store energy. When the switch is open ("off" phase), the stored energy is released through a diode into the output capacitor and load, thus boosting the voltage.

<span style="color:rgb(15, 135, 204);">*Key Equations*</span>

1. On-Interval (Switch Closed):

$$ \frac{di_l}{dt} = \frac{V_{in}}{L} $$

2. Off-Interval (Switch Open):

$$ \frac{di_l}{dt} = \frac{V_{in}-V_{out}}{L} $$

3. Steady-State Voltage Relationship
  
$$ V_{out} = \frac{V_{in}}{1-D} $$

*Where,*

> *- $i_{l}$ : Inductor current [$A$]* <br>
> *- $V_{in}$ : Input voltage [$V$] ; Same as $V_{bat}$* <br>
> *- $L$ : Inductance* <br>
> *- $V_{out}$ : Output voltage [$V$]* <br>
> *- $D$ : Duty cycle*

<br>

#### Buck Converter Model
A buck converter steps down the input voltage by directly controlling the connection between the input and the output via a switch and a diode. When the switch is on, the inductor is energized by the input voltage, and when the switch is off, the inductor current continues to flow through the diode, thereby supplying the load.

<span style="color:rgb(15, 135, 204);">*Key Equations*</span>

1. On-Interval (Switch Closed):

$$ \frac{di_l}{dt} = \frac{V_{in}-V_{out}}{L} $$

2. Off-Interval (Switch Open):

$$ \frac{di_l}{dt} = \frac{-V_{out}}{L} $$

3. Steady-State Voltage Relationship

$$ V_{out} = D\cdot{V_{in}} $$

#### Power Loss Model
In addition to the fundamental voltage conversion behavior, a complete converter model must account for power losses. In both boost and buck converters, losses are generally categorized into conduction loss, switching losses, and parasitic losses. These losses directly impact efficiency and thermal performance.

* A. Conduction Loss

Conduction losses occur when current flows through the circuit elements during on-state. For both converter types, these losses can be expressed as follows:

$$ P_{Mosfet,cond} = I_{in}^2 R_{DS(on)}D $$

$$ P_{Diode,cond} = V_{f}I_{out}(1-D) $$

* B. Switch  Loss:

Switching losses occur when the transition periods are modeled by considering the voltage and current overlap during switching:

$$ P_{sw} = 0.5V_{in}I_{in}f_{sw}(t_{on}+t_{off}) $$

* C. Magnetic core loss:

The core losses result from hysteresis and eddy currents within the inductor or transformer core. These losses vary with frequency and flux density, impacting overall efficiency.

$$ P_{core} = k\cdot f^\alpha B^{\beta} $$

For calculating efficiency,

$$\eta = \frac{P_{out}}{P_{in}}\times 100\% = \frac{P_{out}}{P_{out}+P_{loss}} \times 100\% $$

*Where,*

> *-$R_{DS(on)}$ : On-state resistance of the MOSFET [$\Omega$]* <br>
> *-$f_{sw}$ : Switching frequency [$kHz$]* <br>
> *-$t_{on}, t_{off}$ : Turn-on / turn-off times of the switch [$ns$]* <br>
> *-$V_f$ : Forward voltage drop of the diode [$V$]*

<br>

### 3-Phase Inverter
A 3-phase inverter is used to convert DC into AC for powering a Permanent Magnet Synchronous Motor (PMSM). For high power and high efficiency, SiC-MOSFET is recommended due to low on-state resistance and higher switching speed.

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/three-phase_SIC_circuit.jpg" alt="3-Phase Inverter Circuit Topology" width="500">
    <figcaption>3-Phase Inverter Circuit Topology</figcaption>
  </figure>
</div>

<br>

A SiC MOSFET-based on 3-phase inverter takes DC voltage($V_{dc}$) as input and generates 3-phase AC voltage ($V_a,V_b,V_c$) using Pulse Width Modulation(PWM).

<span style="color:rgb(15, 135, 204);">*Voltage Transformation Model*</span>

Each phase voltage is determined by the switching states of the inverter :

$$ V_a = \frac{V_{DC}}{2}\sin(\omega{t}) $$

$$ V_b = \frac{V_{DC}}{2}\sin(\omega{t}-2\pi/3) $$

$$ V_c = \frac{V_{DC}}{2}\sin(\omega{t}+2\pi/3) $$

<br>

#### Power Loss Model

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/three-phase_SIC_inverter_topology.jpg" alt="Leg a of the 3-Phase SIC Inverter Topology" width="400">
    <figcaption>Leg a of the 3-Phase SIC Inverter Topology</figcaption>
  </figure>
</div>

<br>

* A. Conduction Loss

The Conduction loss happens due to SiC MOSFET's resistive parameters when it is ON. When the current flows through dynamic on-resistance $R_{DS(on)}$, the power is dissipated as heat from the MOSFET.

$$ P_{c(MOSFET)} = I_{m}^2R_{DS(on)}(\frac{1}{8} + \frac{m\cdot{cos{\theta}}}{3\pi}) $$

$$ P_{c(Diode)} = \frac{1}{2\pi} \frac{1}{T_{s}} \int^{\pi}_{0}u_{c(Diode)} i(t) t_{(Diode)} d(\omega t) = I_{m}V_{f}(\frac{1}{2\pi} - \frac{mcos(\theta)}{8}) $$

* B. Switching Loss

The switching loss represent the energy losses and it is classified as a dynamic loss. When the switch of SiC device turn-on and off, it depends on switching frequency, the current through switch and voltage across it.

$$ P_{sw(MOSFET)} = \frac{f_{sw}}{2\pi}\int^{\pi}_{0}(V_{DS(on)}I_{D(on)} + V_{DS(off)}I_{D(off)})dt $$

Total Power loss of 3-phase inverter can be calculated as:

$$ P_{loss} = P_c + P_{sw} $$

$$ P_c = 3(2P_{c(MOSFET)out}+2P_{c(MOSFET)in}+2P_{c(Diode)out}+2P_{c(Diode)in}) $$

$$ P_{sw} = 3(2P_{sw(MOSFET)out}+2P_{sw(MOSFET)in}) $$

*Where,*

> *-$f_{sw}$ : Switching frequency [$kHz$]* <br>
> *-$t_{Diode}$ : Diode conduction time [$\mu s$]* <br>
> *-$I_m$ : Peak current (Amplitude) [$A$]* <br>
> *-$m$ : Modulation index* <br>
> *-$\theta$ : Phase displacement angle* <br>
> *-$R_{ds(on,off)}$ : MOSFET on/off resistance [$\Omega$]* <br>
> *-$V_f$ : Diode forward voltage drop [$V$]* <br>
> *-$T_s$ : Cycle period(=$\frac{1}{f_{sw}}$) [$\mu s$]*

<br>

### Electric Speed Controller (ESC)
The purpose of ESC analysis is to calculate the voltage output through the ESC. The ESC converts the battary voltage into a phased waveform to control the motor's rotation and supply the required thrust. ESC serves two main functions: (1) Controlling the rotation speed of the motor by adjusting the output voltage and frequency, (2) Supplying the current required by the motor to meet the demanded load conditions. The ESC generates an average output voltage based on the PWM (Pulse Width Modulation) duty cycle. Using the input battery voltage and the duty cycle, the ESC output voltage can be calculated accordingly.

<span style="color:rgb(15, 135, 204);">*ESC Analysis Equations*</span>

$$ I_{mot} = I_{esc} $$

$$ V_{ESC} = (V_{battery}-I_{mot}\cdot{R_{ESC}})\cdot{throttle} $$

*Where,*

> *- $V_{batt}$ : Battery voltage [$V$]* <br>
> *- $I_{mot}$ : Motor current [$A$]* <br>
> *- $I_{ESC}$ : ESC output voltage [$V$]* <br>
> *- $R_{ESC}$ : ESC resistance [$\Omega$]* <br>
> *- $throttle$ : Specific throttle value [%]* <br>
> *- $V_{ESC}$ : ESC output voltage [$V$]*

<br>

#### Motor Controller
To control motors typically used in UAM or AAM vehicles, various control logics such as SPWM (Sinusoidal Pulse Width Modulation), SVPWM (Space Vector Pulse Width Modulation), and 6-Step control can be applied. There are well-estabilished mathematical models for implementing PMSM control logic: Clarke transform, Park transform.

<span style="color:rgb(15, 135, 204);">**Clarke Transform**</span>

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/clarke_transform.jpg" alt="Clarke Transform" width="300">
    <figcaption>Clarke Transform</figcaption>
  </figure>
</div>

<br>

The Clake Transform calculates the Clarke transformation of the equilibrium 3-phase component in the abc reference frame and outputs the equilibrium two-phase orthogonal component in the stator $\alpha,\beta$ reference frame. 

$$ V_{\alpha} = \frac{2}{3}(V_a-\frac{1}{2}V_b-\frac{1}{2}V_c) $$

$$ V_{\beta} = \frac{\sqrt{3}}{3}(V_b-V_c) $$

<br>

<span style="color:rgb(15, 135, 204);">**Park Transform**</span>

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/park_transform1.jpg" alt="Park Transform 1" width="300">
    <figcaption>Park Transform (q-Axis)</figcaption>
  </figure>
</div>

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/park_transform2.jpg" alt="Park Transform 2" width="300">
    <figcaption>Park Transform (d-Axis)</figcaption>
  </figure>
</div>

<br>

The Park Transform is used to convert 2-phase stationary reference frame ($\alpha,\beta$) voltages or currents into a rotating reference frame ($d,q$).

$$ V_d = V_{\alpha}cos(\theta) + V_{\beta}sin(\theta) $$

$$ V_q = -V_{\alpha}sin(\theta) + V_{\beta}cos(\theta) $$

*Where,*

> *-$\theta$ : Rotor electrical angle, which varies with motor speed [deg]*

<br>

## **Electric Motor Analysis**

### BLDC Motor
The purpose of the BLDC (Brushless DC) motor analysis module is to calculate the electrical and mechanical behavior of the motor, which converts electrical power into mechanical power. For the motor analysis, ECM is used. Through motor and propeller torque matching, the amount of current required to drive the motor is calculated. Since the motor and propeller are in torque and RPM equilibrium, the motor torque and RPM match the propeller's torque and RPM. Based on the motor specifications, the required current, and the output voltage from the ESC, the motor's RPM can be derived.

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/motor_ecm.jpg" alt="Motor Equivalent Circuit Model" width="500">
    <figcaption>Motor Equivalent Circuit Model</figcaption>
  </figure>
</div>

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/motor_propeller_torque.jpg" alt="Motor Torque Matching" width="500">
    <figcaption>Motor Torque Matching</figcaption>
  </figure>
</div>

<br>

<span style="color:rgb(15, 135, 204);">*Motor Analysis Equations*</span>

$$ I_{mot} = \frac{Q}{\left(\frac{60}{2\pi}\right)K_V} + I_0 $$

$$ RPM = K_V\cdot(V_{ESC}-R_{mot}I_{mot}) $$

*Where,*

> *- $K_V$ : Velocity constant of motor [$RPM/V$]* <br>
> *- $K_t$ : Torque constant of motor [$V/(rad/s)$]* <br>
> *- $I_0$ : Idle current of motor [$A$]* <br>
> *- $Q$ : Torque [$Nm$]* <br>
> *- $R_{mot}$ : Motor resistance [$\Omega$]* <br>
> *- $RPM$ : Motor Rotate Per Minute*

<br>

### PMSM Motor
For PMSM analysis, a simplified ECM is used. The stator resistance and synchronous inductance are typically provided by the motor manufacturer. To analyze motor performance, phase analysis is performed within the d-q reference frame, where the rotor magnetic field defines the d-axis as the reference axis.

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/motor_circuit.png" alt="Phase-wise Equivalent Circuit Model of PMSM" width="500">
    <figcaption>Phase-wise Equivalent Circuit Model of PMSM</figcaption>
  </figure>
</div>

<br>

$$ E_{\phi,mot(q)} = K_{e}\cdot \omega_{rotor} = \frac{\omega_{rotor}}{K_v} $$

$$ Q_{nl} = \frac{P_{mech}}{\omega_{rotor}} $$

$$ Q_{em} = Q_{rotor} + Q_{nl} $$

*Where,*

> *- $E_{\phi,mot(q)}$ : Back electromotive force* <br>
> *- $K_e$ : Back EMF constant [$Vs/rad$]* <br>
> *- $K_v$ : Motor constant [$rpm/V$]* <br>
> *- $Q_{nl}$ : No-load torque [$Nm$]* <br>
> *- $Q_{rotor}$ : Load torque from the propeller [$Nm$]* <br>
> *- $Q_{em}$ : Electromechanical torque [$Nm$]* <br>
> *- $P_{mech}$ : Mechanical power loss of the Motor [$W$]*

<br>

When field weakening is not applied ($I_{\phi,mot(d)} = 0$), the magnitude of the phase current is estimated as :

$$ |I_{\phi,mot}| = I_{\phi,mot(q)} = \frac{Q_{em}}{3 \cdot K_e} = \frac{Q_{em}\cdot K_v}{3} $$

$$ V_{\phi,mot(d)} = -\omega_{rotor}\cdot n_{pp}\cdot L_s\cdot I_{\phi,mot(q)} $$

$$ V_{\phi,mot(q)} = E_{\phi,mot(q)} + R_s\cdot I_{\phi,mot(q)} $$

$$ |V_{\phi,mot}| = \sqrt{V_{\phi,mot(d)}^2 + V_{\phi,mot(q)}^2} $$

*Where,*

> *- $V_{\phi,mot(d)}$ : Voltage at d-axis of the motor* <br>
> *- $V_{\phi,mot(q)}$ : Voltage at q-axis of the motor* <br>
> *- $n_{pp}$ : Number of pole pairs* <br>
> *- $L_s$ : Synchronous inductance of the motor [$mH$]* <br>
> *- $R_s$ : Stator resistance of the motor* <br>
> *- $V_{\phi,mot}$ : Overall voltage magnitude*

<br>

In this analysis, mechanical losses such as windage, friction, and stray losses-which generally account for a minor portion of the total power losses-were considered negligible, in accordance with existing literature. Consequently, mechanical losses were assumed to be equivalent to copper losses when evaluating motor efficiency. In this approach, copper losses due to their significant contribution to the total losses are primarily considered. The total power loss and input power are given by :

$$ P_{cu} = 3\cdot R_s\cdot|I_{\phi,mot}|^2 $$

$$ P_{loss} = P_{cu} + P_{mech} $$

$$ P_{in,mot} = P_{loss} + Q_{rotor}\cdot\omega_{rotor} $$

The modulation index is defined as:

$$ m_a = 2\sqrt2\cdot\frac{|V_{\phi,mot}|}{V_{DC}} $$

*Where,*

> *- $P_{cu}$ : Loss of Copper* <br>
> *- $P_{loss}$ : Loss of total power* <br>
> *- $P_{in,mot}$ : Input power* <br>
> *- $V_{DC}$ : DC bus voltage*

<br>

<span style="color:rgb(15, 135, 204);">*Mathmatical Model of PMSM with d-q Coordinate*</span>

For the IPMSM model, the d-q axis voltage equations under steady-state conditions are expressed as follows :

$$ V_d = R_{s}i_{d} - \omega_{e}L_{q}i_{q} $$

$$ V_q = R_{s}i_{q} + \omega_{e}(L_{d}i_{d} + \psi_{f}) $$

Torque can be calculated as :

$$ T_e = \frac{3}{2}n_p(\psi_{f}i_{q} + (L_{d}+L_{q})i_{d}i_{q}) $$

*Where,*

> *- $R_s$ : Stator resistance [$\Omega$]* <br>
> *- $L_d,L_q$ : d,q inductance [$\mu H$]* <br>
> *- $\psi_f$ : Magnetic flux [$Wb$ or $V\cdot s$]* <br>
> *- $\omega_e$ : Electrical rotational speed [$rad/s$]* <br>
> *- $n_p$ : Number of pole pairs*

<br>

## **Propeller Analysis**
The Propeller performance is estimated using a physics-based approach, viz., Blade Element Momentum Theory.

### Blade Element Theory 
The Blade Element Theory (BET) divides the propeller blade into small, discrete elements along its span. Each blade element is analyzed independently to determine the local aerodynamic forces acting on it. The key steps are as follows :

* Dividing the Blade: The blade is segmented into multiple small elements, each characterized by its local chord length, twist angle, and airfoil properties.

* Calculating Local Forces: For each blade element, the lift and drag forces are calculated based on the local angle of attack and relative wind speed. These forces are then resolved into thrust and torque components.

<br>

### Momentum Theory
The Momentum Theory applies mass and momentum conservation principles to the airflow passing through the propeller disk. It models the propeller as an actuator that imparts momentum to the air, resulting in thrust. The key aspects are as follows :

* Axial Momentum: The change in axial momentum of the airflow is used to determine the thrust generated by the propeller.

* Angular Momentum: The change in angular momentum is used to calculate the torque required to rotate the propeller.

<br>

### Blade Element Momentum Theory
Blade Element Momentum Theory (BEMT) is a fundamental aerodynamic method used to predict the performance of propellers, wind turbines, and other rotary wings. It combines the principle of Blade Element Theory (BET) and Momentum Theory to provide a comprehensive understanding of the aerodynamic forces and moments acting on each blade. BEMT offers a good balance between accuracy and computational efficiency, making it highly suitable for both preliminary design and detailed performance analysis.

The core process involves :

* Iterative Matching: An iterative approach is used to match the local inflow angles and induced velocities predicted by Momentum Theory with those calculated from BET. This ensures consistency between the local aerodynamic forces and the overall momentum balance.

* Induced Velocity Correction: BEMT accounts for the induced velocity (downwash) generated by the propeller which affects the angle of attach and thus the lift and drag forces on each blade element. Correcting for the induced velocity is essential for accurately predicting thrust and torque.

By combining local blade element forces with global momentum conservation, BEMT provides a robust framework for analyzing the aerodynamic performance of rotating wings.

<span style="color:rgb(15, 135, 204);">**Performance Prediction**</span>

By integrating the forces and moments across all blade elements, BEMT provides critical performance parameters of the propeller, such as:

* Thrust: The total axial force generated by the propeller.

* Torque: The total rotational force required to drive the propeller.

* Efficiency: The ratio of useful power output (thrust power) to mechanical power input.

<span style="color:rgb(15, 135, 204);">*Mathmatical Formulation of BET*</span>

This approach involves the blade element analysis, where the propeller blade is divided into numerous sections. For each section, lift and drag forces are calculated based on their unique airfoil characteristics and the prevailing operational conditions, similar to the force dynamics on an aircraft wing. These forces are then resolved along the propeller axis to determine the propeller's resultant thrust and torque.

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/bem.png" alt="Propeller Analysis Using Blade Element Theory Model" width="400">
    <figcaption>Propeller Analysis Using Blade Element Theory Model</figcaption>
  </figure>
</div>

<br>

The forces generated by an elemental blade section are mathematically represented as axial force ($dT$) and angular force ($dQ$). These forces, acting in a plane perpendicular to the blade, are derived from the differential lift ($dL$) and drag ($dD$) forces, considering the inflow angle ($\phi$):

$$ dT = dL\cos\phi - dD\sin\phi $$

$$ dQ = dL\sin\phi + dD\cos\phi $$

Furthermore, expressions can be made in terms of the local resultant wind speed ($V_{R}$), chord length ($c_{r}$), air density ($\rho$), and aerodynamic coefficient ($C_{l},C_{d}$):

$$ dT = 0.5\rho V_{R}^2 c_{r}dr[C_{l}(\alpha)\cos\phi - C_d(\alpha)\sin\phi] $$

$$ dQ = 0.5\rho V_{R}^2 c_{r}dr[C_{l}(\alpha)\sin\phi + C_d(\alpha)\cos\phi] $$

$V_{R}$ and $\phi$ are calculated using the free stream velocity ($V_{\infty}$), rotational speed ($\Omega$), and the axial and angular induction factor ($a$ and $a^{\prime}$):

$$ V_R = \sqrt{[V_{\infty}(1+a)]^2 + [\Omega r(1-a^{\prime})]^2} $$

$$ \phi = \tan^{-1}\left[\frac{V_\infty (1 + a)}{\Omega r(1-a')}\right] $$

The differential thrust ($dT$) and torque ($d\tau$) are computed as follows:

$$ dT = \sigma_{r}\frac{(1+a)^2}{\sin^2\phi}[C_l(\alpha)\cos\phi - C_d(\alpha)\sin\phi]V_{\infty}^2\rho\pi r dr $$

$$ d\tau = \sigma_{r}\frac{(1+a)^2}{\sin^2\phi}[C_l(\alpha)\sin\phi + C_d(\alpha)\cos\phi]V_{\infty}^2\rho\pi r^2 dr $$

Here, $\sigma_{r} = \frac{B c_{r}}{2 \pi r}$ represents the blade solidity, with $B$ being the number of propeller blades.

### Momentum Theory
Momentum theory is based on conceptualizing the propeller as an actuator disk. This idealization represents the propeller as an infinitely thin disk that induces a minor velocity increment ($u$) in the flow direction.

<div style="text-align: center;">
  <figure>
    <img src="_static/fig/disk.png" alt="Propeller Analysis Using Momentum Theory Model" width="600">
    <figcaption>Propeller Analysis Using Momentum Theory Model</figcaption>
  </figure>
</div>

<br>

The analysis assumes that energy states before and after the propeller remain conserved. Applying Bernoulli's theorem, we can express the pressure difference across the actuator disk.

$$ \Delta p = 0.5\rho V_{\infty}^2 4a(1+a) $$

*Where,*

> *- $\Delta p$ : Pressure difference* <br>
> *- $\rho$ : Air density* <br>
> *- $a$ : Axial induction factor*

<br>

Considering the pressure difference over a small area $dA = 2\pi r dr$ of the disk, the incremental thrust is derived as:

$$ dT = 0.5\rho V_{\infty}^2 4a(1+a) dA $$

*Where,*

> *- $r$ : Radial position on the disk*

<br>

For the propeller's rotational effects, the incremental torque ($d\tau$) is linked to the change in angular momentum for an elemental annulus of the disk.

$$ d\tau = \rho V_{d} r^2 \omega dA $$

*Where,*

> *- $\omega$ : Induced angular velocity*

<br>

The angular induction factor, $a^{\prime}$ can be derived as:

$$ a^{\prime} = \frac{\omega}{2\Omega} $$

*Where,*

> *- $\Omega$ : Propeller disk angular velocity*

<br>

The induced velocity ($V_{d}$) through the disk, influenced by $a$ is:

$$ V_d = V_{\infty}(1+a) $$

Integrating the incremental torque over the entire disk yields the total torque:

$$ d\tau = 2a^{\prime}(1+a)\rho V_{\infty}\Omega r^3\pi dr $$

To enhance the accuracy of momentum theory, we incorporate corrections as suggested by Glauert, aligning theoretical predictions with empirical data.

$$ \mathcal{F}_{T}=\frac{2}{\pi}\cos^{-1}\left[e^{-{\frac{B}{2}\left(\frac{R-r}{r |{\sin\phi}|}\right)}}\right] $$

$$ \mathcal{F}_{H}=\frac{2}{\pi}\cos^{-1}\left[e^{-{\frac{B}{2}\left(\frac{r - R_{H}}{r |{\sin\phi}|}\right)}}\right] $$

$$ \mathcal{F} = \mathcal{F}_{T} \mathcal{F}_{H} $$

*Where,*

> *- $\mathcal{F}_{T}$ : Tip loss correction factor* <br>
> *- $\mathcal{F}_{H}$ : Hub loss correction factor* <br>
> *- $\mathcal{F}$ : Glauert tip-hub loss correction factor* <br>
> *- $B$ : Number of blade* <br>
> *- $R$ : Propeller radius* <br>
> *- $r$ : Radial location of a blade element* <br>
> *- $R_H$ : Hub radius* <br>
> *- $\phi$ : Inflow angle*

<br>

The combined effect is applied to the disk loading equations to align with Blade Element Momentum theory solutions. This yields:

$$ \frac{a}{1-a}=\frac{\sigma_r[C_l\cos\phi + C_d\sin\phi]}{4\mathcal{F}\sin ^2\phi} $$

$$ \frac{a^{\prime}}{1+a^{\prime}}=\frac{\sigma_r[C_l\sin\phi - C_d\cos\phi]}{4\mathcal{F}\sin\phi\cos\phi} $$

<br>

X-FOIL is performed for pre-stall aerodynamic coefficients estimation and the Viterna method for post-stall extrapolation:

$$ C_l = \frac{C_{d_{max}}}{2}\sin2\alpha + k_l\frac{\cos^2\alpha}{\sin\alpha} $$

$$ C_d = C_{d_{max}}\sin^2\alpha + k_d\cos\alpha $$

$$ C_{d_{max}}= \begin{cases} 1.11 + 0.018 \, AR, & \text{if } AR \leq 50 \\ 2.01, & \text{otherwise} \end{cases} $$

*Where,*

> *- $C_{d_{max}}$ : Drag coefficient at $\alpha$ = 90$^\circ$* <br>
> *- $k_l$ : Correction factor for lift* <br>
> *- $k_d$ : Correction factor for drag* <br>
> *- $AR$ : Aspect ratio*

<br>

The coefficient $k_{l}$ and $k_{d}$ are calculated using stall coefficients:

$$ k_l = (C_{l{s}} - C_{d_{max}}\sin\alpha_{s}\cos\alpha_{s})\frac {\sin\alpha_{s}}{\cos^2\alpha_{s}} $$

$$ k_d = \frac{C_{d_s}-C_{d_{max}}\sin^2\alpha_s}{\cos\alpha_s} $$

*Where,*

> *- $C_{l_{s}}$ : Lift coefficient at stall condition* <br>
> *- $C_{d_{s}}$ : Drag coefficient at stall condition* <br>
> *- $\alpha_{s}$ : Stall angle of attack*

<br>

To quickly predict $C_{l},C_{d}$ across various $Re$ and $\alpha$, use kriging-based surrogate model and couple it to the propeller model. Once the values of $a,a^{\prime}$ are determined, $T$ and $\tau$ can be estimated by summing $dT$ and $d\tau$ across the entire blade, respectively.

$$ C_T = \frac{T}{\rho n^2 D^4} $$

$$ C_P = \frac{P}{\rho n^3 D^5} $$

$$ P = 2\pi n\tau $$

$$ J = \frac{V}{nD} $$

$$ \eta = J\frac{C_T}{C_P} $$

*Where,*

> *- $n$ : Propeller speed in rotations per second [$rps$]* <br>
> *- $D$ : Propeller diameter [$m$]* <br>
> *- $\eta$ : Propeller efficiency [$\%$]* <br>
> *- $J$ : Advance ratio* <br>
> *- $P$ : Power [$W$]* <br>
> *- $T$ : Thrust [$N$]*
